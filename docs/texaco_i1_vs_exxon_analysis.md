# Texaco_I-1 vs Texaco_Exxon 工况差异与轴向能量诊断

## 一、工况差异分析

### 1.1 工况参数对比

| 参数 | Texaco_I-1 | Texaco_Exxon | 差异 |
|------|------------|--------------|------|
| **煤种** | H-coal_residue_Illinois_No6 | Exxon_DSP_vacuum_tower_bottoms | 不同 |
| **进料** | 76.66 g/s (276 kg/h) | 126.11 g/s (454 kg/h) | Exxon ~1.65× |
| **O2/煤比** | 0.866 | 0.79 | I-1 更高 |
| **蒸汽/煤比** | 0.241 | **0.50** | **Exxon 蒸汽 ~2.1×** |
| **入口温度** | 505.22 K | 505.22 K | 相同 |
| **热损失** | 3% | 3% | 相同 |
| **浆液浓度** | 100% (熔融残渣) | 100% | 相同 |

### 1.2 煤质对比

| 组分 | Texaco_I-1 (Illinois H-coal) | Texaco_Exxon (DSP) |
|------|------------------------------|---------------------|
| C | 74.05% | 70.74% |
| H | 6.25% | 4.67% |
| O | 1.32% | 3.95% |
| Ash | 15.53% | 16.72% |
| HHV | 29.8 MJ/kg | Dulong 估算 |

### 1.3 关键差异总结

1. **蒸汽量**：Exxon 蒸汽/煤比 0.50 vs I-1 的 0.241，**Exxon 蒸汽量约为 I-1 的 2.1 倍**
2. **O2/煤比**：I-1 更高 (0.866)，氧化更强；Exxon 略低 (0.79)
3. **进料量**：Exxon 更大，停留时间略短
4. **煤质**：Exxon 的灰分略高、挥发分可能不同，影响气化/燃烧行为

### 1.4 出口温度对比（当前模型）

| 工况 | Cell 0 | 出口 | 实验/预期 |
|------|--------|------|-----------|
| Texaco_I-1 | 2359°C | **801°C** | 1370°C |
| Texaco_Exxon | 2266°C | **1226°C** | - |

**结论**：Exxon 出口温度明显高于 I-1（1226 vs 801°C）。差异可能来自：
- I-1 蒸汽少 → 若模型对 C+H2O 气化/蒸汽稀释敏感，I-1 可能被过度冷却
- 或 I-1 的下游 cell 更易陷入低温解（初值/求解敏感）

---

## 二、轴向能量平衡诊断

### 2.1 诊断脚本

运行以下命令生成逐 cell 能量分解与温度突降识别：

```bash
cd gasifier-1d-kinetic
PYTHONPATH=src python tests/diagnostics/compare_i1_exxon_energy.py
```

脚本输出：
1. **工况差异**：煤种、进料、O2/蒸汽比等
2. **轴向能量**：每 cell 的 H_in, H_out, energy_src, Q_loss, Q_ox, Q_gasif, Q_wgs
3. **温度突降 cell**：dT < -150 K 或相对降幅 > 12% 的 cell
4. **能量分解**：温度突降 cell 的放热/吸热细分

### 2.2 温度突降判据

- 单格降温 **> 150 K**
- 或相对降幅 **> 12%**（-dT / T_in）

### 2.3 预期关注点

- **Texaco_I-1**：若前期 cell 出现连续大幅降温，检查
  - C+H2O 气化速率是否过高
  - WGS 逆向 (CO2+H2→CO+H2O) 吸热是否被放大
  - 能量残差 res_E 是否在突降 cell 异常
- **Texaco_Exxon**：蒸汽多但出口温度更高，可对比
  - 轴向 Q_gasif 分布
  - 温度突降 cell 数量与位置

---

## 三、温度突降 cell 分析框架

对识别出的温度突降 cell，逐一检查：

| 检查项 | 含义 |
|--------|------|
| Q_ox | 氧化放热，应使温度升高 |
| Q_gasif | 气化吸热 (C+H2O, C+CO2, MSR)，使温度下降 |
| Q_wgs | WGS 反应热，正向略放热、逆向吸热 |
| energy_src | 热解/蒸发等源项 |
| res_E | 能量残差，应接近 0（收敛时） |

若某 cell 的 **Q_gasif** 或 **Q_wgs** 吸热异常大，而 **Q_ox** 很小，则降温合理；反之若吸热不大却温度骤降，疑为**求解多解 / 初值问题**。

---

## 四、运行说明

诊断脚本约需 3–5 分钟（2 个工况 × 60 cells）。若需快速测试，可使用 `-n 30` 或 `-n 40`。

---

## 五、诊断结果（2026-02 实测）

### 5.1 温度突降 cell（Texaco_I-1）

| Cell | z(m) | T_in→T_out | dT(K) | Q_ox | Q_gasif | Q_wgs |
|------|------|------------|-------|------|---------|-------|
| 1 | 0.075 | 2632→2288 | **-344** | 0.00 | -0.11 | **-1.71** |
| 2 | 0.125 | 2288→2088 | -200 | 0.00 | -0.06 | +0.35 |
| 3 | 0.175 | 2088→1917 | -172 | 0.00 | -0.04 | -0.47 |

**Texaco_Exxon**：无显著温度突降 cell（单格 dT 均 < 150 K）。

### 5.2 核心发现

1. **Cell 1 主因：WGS 逆向吸热**  
   - Q_wgs = **-1.71 MW**（CO2+H2→CO+H2O 强吸热）  
   - Q_gasif 仅 -0.11 MW，C+H2O/C+CO2 气化贡献很小  
   - **WGS 逆向反应被过度放大**，导致 Cell 1 降温 344 K

2. **Exxon 无突降**  
   - 蒸汽多（0.5 vs 0.241）→ H2O 浓度高，WGS 平衡方向可能不同  
   - 进料大、停留时间短，可能限制 WGS 进行程度  
   - 或 Exxon 求解未陷入同一低温解

3. **后续改进方向**  
   - 检查 WGS 动力学/平衡：活化能、指前因子、平衡常数  
   - 限制 WGS 逆向速率或引入平衡约束  
   - 考虑 Texaco_I-1 燃烧区出口 O2 耗尽的特殊条件

### 5.3 已实施：Fortran T≤1000K 关闭 WGS

- `kinetics_service.py`: WGS 判据改用颗粒温度 Ts（`Ts_particle`），与 Fortran wgshift 一致
- `Ts_particle <= 1000K` 时 WGS=0；未提供 Ts 时回退到气相 T
- 对 Texaco_I-1 改善有限：突降 cell 中 Ts_avg 已 >1000K，WGS 仍参与计算

### 5.4 已实现：燃烧区 RK-Gill 颗粒温度（可选）

- `cell.py`: 燃烧区可选用 Fortran Runge-Kutta-Gill (Line 459-475)，含 C+O2/C+H2O/C+CO2 反应热
- `PhysicalConstants.USE_RK_GILL_COMBUSTION = True` 启用；默认 False（计算量约 4x）
- **燃烧区**：C+O2 放热使 Ts 升高；**气化区**：C+H2O/C+CO2 吸热使 Ts 降低
- 气化区已纳入 RK-Gill：C+H2O/C+CO2 吸热使 Ts 降低，可抑制 WGS（Ts≤1000 时 WGS=0）
